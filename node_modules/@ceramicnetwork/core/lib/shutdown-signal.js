import { Subject } from 'rxjs';
export class ShutdownSignal {
    constructor() {
        this.subject = new Subject();
    }
    get observers() {
        return this.subject.observers;
    }
    abort() {
        this.subject.complete();
    }
    abortable(fn) {
        const controller = new AbortController();
        const onAbort = () => {
            controller.abort();
        };
        const subscription = this.subject.subscribe({
            complete: () => {
                onAbort();
            },
        });
        if (this.subject.isStopped)
            controller.abort();
        return fn(controller.signal).finally(() => {
            subscription.unsubscribe();
        });
    }
}
//# sourceMappingURL=shutdown-signal.js.map
import { writeHeapSnapshot } from 'node:v8';
function timestamp(timestamp = new Date()) {
    return timestamp.toISOString().replace(/\.\d+/, '');
}
export function handleHeapdumpSignal(folder, logger) {
    process.on('SIGUSR2', () => {
        const filepath = new URL(`./ceramic-${timestamp()}.heapsnapshot`, folder);
        logger.write(`heapdump started: ${filepath.pathname}`);
        writeHeapSnapshot(filepath.pathname);
        logger.write(`heapdump finished: ${filepath.pathname}`);
    });
}
//# sourceMappingURL=handle-heapdump-signal.js.map